# 字典

Updated YYYY/MM/DD

善用 Ctrl + F 并查看文件目录, 每项下面的是在控制台查看对应内容的命令行

## avatar_id (头像)

`cfg.item_definition.skin.map_`

头像和所用角色是分开的, 不过在 main.js 中统一了

id 以 4 开头, 400000 和 400001 分别是女, 男角色的默认皮肤(背影), 最好不要用

##########

## charid (角色)

`cfg.item_definition.character.map_`

id 以 2 开头

##########

## item (views, 装扮等包括头像框在内的非常多的内容)

`cfg.item_definition.item.map_`

id 以 3 开头, 包含头像框在内的装扮, 此外还有礼物, 宝玉, 加载图等杂七杂八的没列出来

这部分对应牌谱里面 `views` 这一项, `slot: 0` 之类也是这个意思

具体哪种装扮对应哪个 `slot` 可以使用命令行 `game.EView`

由于猫粮奇葩的管理导致id的使用很乱, 我这里直接分类, 而不是只按照 id 大小排序了

注意有部分内容是限定的或者测试用的, 乱用可能会导致封号

### 立直棒

**所在(牌谱信息文件的) slot: 0**

##########

### 和牌特效

**所在 slot: 1**

##########

### 立直特效

**所在 slot: 2**

##########

### 鸣牌指示 (回放中无法展现)

**所在 slot: 10**

##########

### 手的样式

**所在 slot: 3**

##########

### 立直音乐 (回放中无法展现)

**所在 slot: 4**

##########

### 头像框

**所在 slot: 5**

##########

### 桌布 (与对局玩家无关)

**所在 slot: 6**

##########

### 牌背 (与对局玩家无关)

**所在 slot: 7**

##########

### 牌面 (与对局玩家无关)

**所在 slot: 13**

##########

### 大厅背景 (与对局无关)

**所在 slot: 8**

##########

### 大厅音乐 (与对局无关)

##########

### 对局音乐 (与对局无关)

##########

## title (称号)

`cfg.item_definition.title.map_`

对局及牌谱中, 不同服的玩家称号不会显示

id 以 6 开头, 而且有点乱, 很多都限时且无法获得, 乱用可能会封号

##########

## config (对局的模式)

两个命令行结果对比着出来的, 主要参考第一个, 感谢"姬萌萌"的作者 [Paulzzh](https://space.bilibili.com/73796753)

`cfg.desktop.matchmode.map_`

`cfg.game_live.select_filters.map_`

包含 category, mode_id, mode 的信息, 其他的都比较好理解

还有部分数据参考了这个网站: [定数一覧にゃ#ゲームメタモード](https://wikiwiki.jp/majsoul-api/%E5%AE%9A%E6%95%B0%E4%B8%80%E8%A6%A7%E3%81%AB%E3%82%83#bd8d1986)

目前规律是:

- category 的有效值只有 1, 2, 4, 分别表示 友人场, 匹配场, 比赛场
- mode_id 只有在 category 为 2 时才有效(其他值时默认为0)
- mode
    - 个位 0, 1, 2, 3 分别表示 一局战, 东风战, 半庄战, 人机战, 4 和 0 一样
    - 十位 0, 1 分别表示四麻, 三麻, 2 的话就是二人麻将

| category | mode_id | mode |  名称1  | 名称2  |      备注/特殊规则关键词       |
|:--------:|:-------:|:----:|:-----:|:----:|:---------------------:|
|    1     |    0    |  0   |  友人场  | 四人一局 |
|    1     |    0    |  1   |  友人场  | 四人东  |        该仓库默认使用        |
|    1     |    0    |  2   |  友人场  | 四人南  |
|    1     |    0    |  3   |  友人场  | 四人人机 |
|    1     |    0    |  4   |  友人场  | 四人一局 |
|    1     |    0    |  10  |  友人场  | 三人一局 |
|    1     |    0    |  11  |  友人场  | 三人东  |        该仓库默认使用        |
|    1     |    0    |  12  |  友人场  | 三人南  |
|    1     |    0    |  13  |  友人场  | 三人人机 |
|    1     |    0    |  14  |  友人场  | 三人一局 |
|    2     |    1    |  0   |  铜之间  | 四人一局 |
|    2     |    2    |  1   |  铜之间  | 四人东  |
|    2     |    3    |  2   |  铜之间  | 四人南  |
|    2     |    4    |  0   |  银之间  | 四人一局 |
|    2     |    5    |  1   |  银之间  | 四人东  |
|    2     |    6    |  2   |  银之间  | 四人南  |
|    2     |    7    |  0   |  金之间  | 四人一局 |
|    2     |    8    |  1   |  金之间  | 四人东  |
|    2     |    9    |  2   |  金之间  | 四人南  |
|    2     |   10    |  0   |  玉之间  | 四人一局 |
|    2     |   11    |  1   |  玉之间  | 四人东  |
|    2     |   12    |  2   |  玉之间  | 四人南  |
|    2     |   13    |  1   | 乱斗之间  | 四人东  |
|    2     |   14    |  2   | 乱斗之间  | 四人南  |
|    2     |   15    |  1   |  王座间  | 四人东  |
|    2     |   16    |  2   |  王座间  | 四人南  |
|    2     |   17    |  11  |  铜之间  | 三人东  |
|    2     |   18    |  12  |  铜之间  | 三人南  |
|    2     |   19    |  11  |  银之间  | 三人东  |
|    2     |   20    |  12  |  银之间  | 三人南  |
|    2     |   21    |  11  |  金之间  | 三人东  |
|    2     |   22    |  12  |  金之间  | 三人南  |
|    2     |   23    |  11  |  玉之间  | 三人东  |
|    2     |   24    |  12  |  玉之间  | 三人南  |
|    2     |   25    |  11  |  王座间  | 三人东  |
|    2     |   26    |  12  |  王座间  | 三人南  |      27, 28 没有信息      |
|    2     |   29    |  1   | 休闲普通场 | 四人东  |
|    2     |   30    |  2   | 休闲普通场 | 四人南  |
|    2     |   31    |  11  | 休闲普通场 | 三人东  |
|    2     |   32    |  12  | 休闲普通场 | 三人南  |
|    2     |   33    |  1   | 宝牌狂热  | 四人东  |     `dora3_mode`      |
|    2     |   34    |  1   | 配牌明牌  | 四人东  |   `begin_open_mode`   |
|    2     |   35    |  1   | 龙之目玉  | 四人东  |      `muyu_mode`      |
|    2     |   36    |  1   | 试炼之道  | 四人东  |
|    2     |   37    |  12  | 龙争虎斗  | 三人南  |
|    2     |   38    |  12  | 龙争虎斗  | 三人南  |
|    2     |   39    |  12  | 龙争虎斗  | 三人南  |
|    2     |   40    |  1   | 修罗之战  | 四人东  |    `xuezhandaodi`     |
|    2     |   41    |  1   | 赤羽之战  | 四人东  |       `chuanma`       |
|    2     |   42    |  1   |  活动场  | 四人东  |
|    2     |   43    |  1   |  活动场  | 四人东  |
|    2     |   44    |  1   | 明镜之战  | 四人东  |    `jiuchao_mode`     |
|    2     |   45    |  1   | 暗夜之战  | 四人东  |   `reveal_discard`    |
|    2     |   46    |  1   | 幻境传说  | 四人东  |  `field_spell_mode`   |
|    2     |   47    |  1   | 占星之战  | 四人东  |      `zhanxing`       |
|    2     |   48    |  1   | 天命之战  | 四人东  |    `tianming_mode`    |
|    2     |   49    |  1   | 咏唱之战  | 四人东  |   `yongchang_mode`    |
|    2     |   50    |  1   | 魂之一击  | 四人东  |   `hunzhiyiji_mode`   |
|    2     |   51    |  1   | 万象修罗  | 四人东  | `wanxiangxiuluo_mode` |
|    2     |   52    |  1   | 背水之战  | 四人东  | `beishuizhizhan_mode` |
|    4     |    0    |  0   |  比赛场  | 四人一局 |
|    4     |    0    |  1   |  比赛场  | 四人东  |
|    4     |    0    |  2   |  比赛场  | 四人南  |
|    4     |    0    |  3   |  比赛场  | 四人人机 |
|    4     |    0    |  4   |  比赛场  | 四人一局 |
|    4     |    0    |  10  |  比赛场  | 三人一局 |
|    4     |    0    |  11  |  比赛场  | 三人东  |
|    4     |    0    |  12  |  比赛场  | 三人南  |
|    4     |    0    |  13  |  比赛场  | 三人人机 |
|    4     |    0    |  14  |  比赛场  | 三人一局 |

## level (段位制度)

`cfg.level_definition.level_definition.map_`

1开头的是四麻, 2开头的是三麻

| level_id |  名称  |
|:--------:|:----:|
|  10101   | 初心一星 |
|  10102   | 初心二星 |
|  10103   | 初心三星 |
|  10201   | 雀士一星 |
|  10202   | 雀士二星 |
|  10203   | 雀士三星 |
|  10301   | 雀杰一星 |
|  10302   | 雀杰二星 |
|  10303   | 雀杰三星 |
|  10401   | 雀豪一星 |
|  10402   | 雀豪二星 |
|  10403   | 雀豪三星 |
|  10501   | 雀圣一星 |
|  10502   | 雀圣二星 |
|  10503   | 雀圣三星 |
|  10601   | 旧魂天* |
|  107XX   | 新魂天  |
|          |      |
|  20101   | 初心一星 |
|  20102   | 初心二星 |
|  20103   | 初心三星 |
|  20201   | 雀士一星 |
|  20202   | 雀士二星 |
|  20203   | 雀士三星 |
|  20301   | 雀杰一星 |
|  20302   | 雀杰二星 |
|  20303   | 雀杰三星 |
|  20401   | 雀豪一星 |
|  20402   | 雀豪二星 |
|  20403   | 雀豪三星 |
|  20501   | 雀圣一星 |
|  20502   | 雀圣二星 |
|  20503   | 雀圣三星 |
|  20601   | 旧魂天* |
|  207XX   | 新魂天  |

*这个是2021/8/26之前魂珠制度还没实行的时候所用的魂天段位分, 在这之后用的都是7XX的, XX = 01~20, 代表20个魂天lv

## 役种一览

`cfg.fan.fan.map_`

`show_index` 是报菜名界面排序的权重值, 按照其值升序排列

1000 到 1021 是赤羽之战使用的番种

| fan_id |   名称    | show_index |     备注      |
|:------:|:-------:|:----------:|:-----------:|
|   1    | 门前清自摸和  |     70     |
|   2    |   立直    |     10     |
|   3    |   枪杠    |     30     |
|   4    |  岭上开花   |     40     |
|   5    |  海底摸月   |     50     |
|   6    |  河底捞鱼   |     60     |
|   7    |  役牌 白   |    120     |
|   8    |  役牌 发   |    130     |
|   9    |  役牌 中   |    140     |
|   10   | 役牌:门风牌  |    150     |
|   11   | 役牌:场风牌  |    160     |
|   12   |   断幺九   |    170     |
|   13   |   一杯口   |     90     |
|   14   |   平和    |     80     |
|   15   |  混全带幺九  |    180     |
|   16   |  一气通贯   |    190     |
|   17   |  三色同顺   |    200     |
|   18   |   两立直   |     10     |
|   19   |  三色同刻   |    220     |
|   20   |   三杠子   |    230     |
|   21   |   对对和   |    240     |
|   22   |   三暗刻   |    250     |
|   23   |   小三元   |    260     |
|   24   |   混老头   |    270     |
|   25   |   七对子   |    110     |
|   26   |  纯全带幺九  |    280     |
|   27   |   混一色   |    290     |
|   28   |   二杯口   |    100     |
|   29   |   清一色   |    300     |
|   30   |   一发    |     20     |
|   31   |   宝牌    |    310     |
|   32   |   红宝牌   |    320     |
|   33   |   里宝牌   |    340     |
|   34   |  拔北宝牌   |    330     |
|   35   |   天和    |    350     |
|   36   |   地和    |    360     |
|   37   |   大三元   |    370     |
|   38   |   四暗刻   |    380     |
|   39   |   字一色   |    390     |
|   40   |   绿一色   |    400     |
|   41   |   清老头   |    410     |
|   42   |  国士无双   |    420     |
|   43   |   小四喜   |    430     |
|   44   |   四杠子   |    440     |
|   45   |  九莲宝灯   |    450     |
|   46   |   八连庄   |    460     |  未实装古役, 役满  |
|   47   | 纯正九莲宝灯  |    470     |
|   48   |  四暗刻单骑  |    480     |
|   49   | 国士无双十三面 |    490     |
|   50   |   大四喜   |    500     |
|   51   |   燕返    |     11     |   古役, 1番    |
|   52   |   杠振    |     12     |   古役, 1番    |
|   53   |  十二落抬   |     13     |   古役, 1番    |
|   54   |   五门齐   |    293     |   古役, 2番    |
|   55   |   三连刻   |    291     |   古役, 2番    |
|   56   |  一色三同顺  |    292     | 古役, 食下役, 3番 |
|   57   |  一筒摸月   |    301     |   古役, 满贯    |
|   58   |  九筒捞鱼   |    302     |   古役, 满贯    |
|   59   |   人和    |    590     |   古役, 役满    |
|   60   |   大车轮   |    600     |   古役, 役满    |
|   61   |   大竹林   |    610     |   古役, 役满    |
|   62   |   大数邻   |    620     |   古役, 役满    |
|   63   |  石上三年   |    630     |   古役, 役满    |
|   64   |   大七星   |    640     |  古役, 双倍役满   |
|   65   |   人和    |    591     |   满贯打点的版本   |
|  801   |    绯    |    801     |   咏唱之战使用    |
|  802   |    苍    |    802     |   咏唱之战使用    |
|  803   |   过载    |    803     | 魂之一击使用, 2番  |
|  804   |   立直    |     10     | 魂之一击使用, 2番  |
|  805   |   两立直   |     10     | 魂之一击使用, 3番  |
|  806   |  真-立直   |     10     | 背水之战使用, 3番  |
|  807   |  真-两立直  |     10     | 背水之战使用, 4番  |
|  808   |  极-立直   |     10     | 背水之战使用, 5番  |
|  809   |  极-两立直  |     10     | 背水之战使用, 6番  |
|  1000  |    根    |    1084    | 赤羽之战使用, 下同  |
|  1001  |   杠上花   |    1081    |
|  1002  |   杠上炮   |    1802    |
|  1003  |   底和    |    1000    |
|  1004  |   抢杠    |    1083    |
|  1005  |   对对和   |    1020    |
|  1006  |   清一色   |    1021    |
|  1007  |   七对子   |    1022    |
|  1008  |   带幺九   |    1023    |
|  1009  |   金钩钓   |    1024    |
|  1010  |   清对    |    1010    |
|  1011  |   将对    |    1011    |
|  1012  |   龙七对   |    1012    |
|  1013  |   清七对   |    1013    |
|  1014  |  清金钩钓   |    1015    |
|  1015  |  清龙七对   |    1003    |
|  1016  |  十八罗汉   |    1004    |
|  1017  |  清十八罗汉  |    1005    |
|  1018  |   天和    |    1001    |
|  1019  |   地和    |    1002    |
|  1020  |   清幺九   |    1014    |
|  1021  |  海底捞月   |    1014    |

## 其他杂项信息

### 段位场规则详细说明

源自中文服官网: https://www.maj-soul.com/#/introduce 右边"规则介绍"部分

#### 段位四人场规则

- 25000点原点，结算时一位必要点数30000点。
- 马点：一位+15、二位+5、三位-5、四位-15。
- 有食断、有后付、无食替。
- 赤宝牌：红5万、红5筒、红5索各1张。
- 不听流局下庄，听牌连庄。
- 有东风战南入、东南战西入，当没有玩家超过30000点时将进行加时赛。
- 加时赛最长加时到南风局结束或西风局结束，强制进行结算。
- 加时赛中一旦有玩家超过30000点即立刻结束游戏，但若存在庄家连庄的情况时，连庄优先。
- 有击飞规则。点数为负数时立即结束游戏，负数部分的点数一同计算，0点时继续游戏。
- 东四局/南四局结束时，庄家为一位，超过30000点且满足要求可以连庄时，不再连庄，结束游戏。
- 游戏结束时，由一位获得全部场供。
- 游戏结束时，存在玩家相同点数的情况下，由东一局的座位顺序决定顺位。
- 途中流局：九种九牌、四风连打、四家立直、四杠散了。途中流局连庄。
- 九种九牌是在没有吃、碰、明杠、暗杠的情况下，第一次摸牌，手牌有9种及以上么九牌，可以不流局。
- 有流局满贯。当发生流满时不进行听牌清算而是流满清算，若庄家听牌则连庄。
- 流局满贯需要在自己的牌河没有被鸣牌的情况下才成立。自己可以鸣牌。
- 无头跳抢和，有多家和牌，所有荣和均按逆时针进行结算。
- 若多家和牌，供托由头跳家获得，庄家和牌则连庄。
- 有包牌：大三元、大四喜。四杠子不包牌。没有包杠。当涉及多役满复合的情况时，点数支付规则仅适用于包牌役满的部分，其余正常计算。
- 有形式听牌，不承认虚听。（虚听为当自己的所有听牌均在自己的纯手牌中，听第5张牌的情况）
- 立直宣言必须要在1000点及以上，且剩余牌大于等于4张时才可发出。立直宣言牌放铳的情况下，算立直不成立，不收宣言供托。
- 有立直振听：立直后见逃和牌则进入振听。
- 立直后的暗杠必须在不改变听牌型的情况下才可以进行。
- 有杠宝牌和杠里宝牌：暗杠直接翻杠宝牌，明杠或加杠情况下在摸到岭上牌并打出一张牌后翻杠宝牌。
- 有同巡振听：当自己切牌后解除同巡振听。
- 不可以鸣海底牌。
- 振听只判定牌河中的牌（加杠等不适用）
- 当前没有八连庄、人和、大车轮、三连刻、一色三顺、十三不塔等地方役种或古役。
- 庄家起手配14张牌，天和时14张牌均可作为自摸牌，和牌动画时默认显示顺序排列最后一张。当复合其他涉及听张役满牌型时，均按照高点法计算，即复合四暗刻单骑、国士无双十三面、纯正九连宝灯，上述情况为三倍役满。

#### 段位三人场规则

- 起点：35000点，结算时一位必要点数40000点。
- 马点：一位+15、二位+0、三位-15。
- 有食断、有后付、有自摸损；不允许“吃”。
- 赤宝牌：红5筒、红5索各1张。
- 岭上牌共8张；北风牌可以执行“拔北”作为宝牌使用，“拔北”之后会摸一张岭上牌，“拔北”操作等同于鸣牌（消除一发、地和、九种九牌流局、两立直），不破坏门前清。
- 拔北自摸算岭上开花役。
- 允许在他家拔北时执行抢北和，抢北和不算役。
- 北风作为面子时算客风。
- 不使用2万-8万的牌，1万和9万互为宝牌指示牌。
- 不听流局下庄，听牌连庄。
- 当没有玩家超过40000点时将进行加时赛，东风战南入、东南战西入，。
- 加时赛最长加时到南风局结束或西风局结束，强制进行结算。
- 加时赛中一旦有玩家超过40000点即立刻结束游戏，但若存在庄家连庄的情况时，连庄优先。
- 有击飞规则。点数为负数时立即结束游戏，负数部分的点数一同计算，0点时继续游戏。
- 东四局/南四局结束时，庄家为一位，超过40000点且满足要求可以连庄时，不再连庄，结束游戏。
- 游戏结束时，由一位获得全部供托。
- 游戏结束时，存在玩家相同点数的情况下，由东一局的座位顺序决定顺位。
- 途中流局：九种九牌、四杠散了。途中流局连庄。
- 九种九牌是在没有吃、碰、明杠、暗杠、拔北的情况下，第一次摸牌，手牌有9种及以上么九牌，可以不流局。
- 有流局满贯。当发生流满时不进行听牌清算而是流满清算，若庄家听牌则连庄。
- 流局满贯需要在自己的牌河没有被鸣牌的情况下才成立。自己可以鸣牌。
- 无头跳抢和，有多家和牌，所有荣和均按逆时针进行结算。
- 若多家和牌，供托由头跳家获得，庄家和牌则连庄。
- 有包牌：大三元、大四喜。四杠子不包牌。没有包杠。当涉及多役满复合的情况时，点数支付规则仅适用于包牌役满的部分，其余正常计算。
- 有形式听牌，不承认虚听。（虚听为当自己的所有听牌均在自己的纯手牌中，听第5张牌的情况）
- 立直宣言必须要在1000点及以上，且剩余牌大于等于4张时才可发出。立直宣言牌放铳的情况下，算立直不成立，不收宣言供托。
- 有立直振听：立直后见逃和牌则进入振听。
- 立直后的暗杠必须在不改变听牌型的情况下才可以进行。
- 有杠宝牌和杠里宝牌：暗杠直接翻杠宝牌，明杠或加杠情况下在摸到岭上牌并打出一张牌后翻杠宝牌。
- 有同巡振听：当自己切牌后解除同巡振听。
- 不可以鸣海底牌。
- 振听只判定牌河中的牌（加杠、拔北等不适用）
- 当前没有八连庄、人和、大车轮、三连刻、十三不塔等地方役种或古役。
- 庄家起手配14张牌，天和时14张牌均可作为自摸牌，和牌动画时默认显示顺序排列最后一张。当复合其他涉及听张役满牌型时，均按照高点法计算，即复合四暗刻单骑、国士无双十三面、纯正九连宝灯，上述情况为三倍役满。

### 查看加载界面的所有提示语

在控制台输入

`uiscript.UI_Loading.Inst.tips`

25年7月结果(顺序是随机的):

| 序号 |                    内容                    |
|:--:|:----------------------------------------:|
| 1  |                功夫再高，也怕断幺                 |
| 2  |           放铳不是结束，All Last 只是开始           |
| 3  |            在点数不足一千点时，是无法立直的哦             |
| 4  |            荣和不是四暗刻，七对子也没有一杯口             |
| 5  |            点击设置按钮，可以查看游戏内的番型             |
| 6  |            设置里可以根据偏好选择单击/双击出牌            |
| 7  |            雀士的服饰需拥有对应雀士后才可以使用            |
| 8  |           更改昵称后的30天内是无法再次更改的哟            |
| 9  |           四人麻将天和的概率大概在三十三万分之一            |
| 10 |          “永远”不要将你的账号密码告诉其他人！！！           |
| 11 |          悬赏任务和杂货屋会在每天的05:00刷新内容          |
| 12 |           八木唯很喜欢喝咖啡，但是她实际上是个味痴           |
| 13 |          七对子不可以有重复的对子，但是两杯口可以有           |
| 14 |         即使你的胃口再大，在三人麻将中也不可以“吃”牌          |
| 15 |          相原舞其实是千月神社的巫女，并不是魂天神社的          |
| 16 |         只有国士无双才可以抢暗杠，其他牌型都无法抢暗杠          |
| 17 |         段位战中当同桌所有玩家为魂天时，会触发巅峰对决          |
| 18 |         观战会有5分钟的延迟，所以不要想着偷偷看别人牌哦         |
| 19 |         寮舍内可以使用星标为雀士排序，并可以切换显示方式         |
| 20 |       邮箱账号可以自由切换各个平台（steam、网页、手机）        |
| 21 |       三人麻将中是没有2~8万的，所以1万和9万互相指示宝牌        |
| 22 |        一姬的爱好是吃和睡觉，不知道你也有没有同样的爱好呢         |
| 23 |        有役才能和牌，鸣牌（吃碰杠）之前先确认自己是否有役哟        |
| 24 |       点击牌谱界面的“星星”按钮，就可以把自己喜欢的牌谱收藏啦       |
| 25 |    使用IE或UC浏览器可能会遇到卡顿的情况，推荐使用QQ和chrome    |
| 26 | 我们的官网是www.maj-soul.com，可以在这里找到所有客户端的下载地址 |
| 27 |  如果对游戏有建议或需要帮助，可以在【设置】-【其他】内找到【帮助&支持】功能  |

### 查看轮换的活动场的轮次顺序

```js
{ // 在控制台输入
    let a = [], b = {};
    cfg.desktop.matchmode.forEach(i => b[i.id] = i.room_name_chs);
    cfg.activity.activity_desktop.getGroup(230143).forEach(i => a.push(b[i.desktop_id]));
    a
}
```

### 查看插画屋售卖插画的轮次顺序及所需宝玉

```js
{ // 在控制台输入
    let a = [];
    cfg.shops.interval_refresh_goods.groups_[1001].forEach(r =>
        a[r.interval - 1] === undefined ?
            a[r.interval - 1] = [] :
            a[r.interval - 1].push({
                name: cfg.item_definition.item.map_[cfg.shops.goods.map_[r.goods_id].item_id].name_chs,
                jade: cfg.item_definition.item.map_[parseInt(cfg.shops.goods.map_[r.goods_id].price.split('-')[0])].name_chs
            })
    );
    a
}
```

### 查看高光时刻所有类型勋章方法

```js
{ // 在控制台输入
    let a = [];
    cfg.achievement.badge_group.forEach(r =>
        a.push({
            name: game.Tools.strOfLocalization(r.name),
            desc: game.Tools.strOfLocalization(r.desc)
        })
    );
    a
}
```

24年12月结果:

| 序号 |    名称     |                     内容                      |
|:--:|:---------:|:-------------------------------------------:|
| 1  | 完美对局(段位场) |           整场对局无放铳, 有4次满贯或更高番数的和牌            |
| 2  | 连胜之证(段位场) |  在东风或半庄对局中, 连续获得第1名5次(四人麻将/三人麻将的连胜次数独立统计)   |
| 3  | 大逆转(段位场)  |           和牌倍满以上后对局结束, 从最后一名变为第1名           |
| 4  | 役满之证(段位场) |                    和出役满                     |
| 5  | 超高分(段位场)  |             终局时, 所持点数超过100000点              |
|    |           |                                             |
| 6  | 完美对局(友人场) |    整场对局无放铳, 有4次满贯或更高番数的和牌(东风或半庄对局, 无电脑)     |
| 7  | 连胜之证(友人场) | 连续获得第1名5次(东风或半庄对局, 无电脑, 四人麻将/三人麻将的连胜次数独立统计) |
| 8  | 大逆转(友人场)  |    和牌倍满以上后对局结束, 从最后一名变为第1名(东风或半庄对局, 无电脑)    |
| 9  | 役满之证(友人场) |             和出役满(东风或半庄对局, 无电脑)              |
| 10 | 友尽局(友人场)  |       整局未放铳, 结束时获得最后一名(东风或半庄对局, 无电脑)        |
|    |           |                                             |
| 11 | 完美对局(活动场) |           整场对局无放铳, 有4次满贯或更高番数的和牌            |
| 12 | 连胜之证(活动场) |        连续获得第1名5次(四人麻将/三人麻将的连胜次数独立统计)        |
| 13 | 大逆转(活动场)  |           和牌倍满以上后对局结束, 从最后一名变为第1名           |
| 14 | 役满之证(活动场) |                    和出役满                     |
| 15 | 强力击飞(活动场) |           和牌后对局结束, 且有两名或以上其他玩家被击飞           |

### 国际中文服历届四象战所用看板角色服饰

| 四象战次别  |  看板角色服饰   | avatar_id |    备注    |
|:------:|:---------:|:---------:|:--------:|
|  第一届   |  辉夜姬-契约   |  402902   | 2020年11月 |
|  第二届   |  九条璃雨-契约  |  400802   | 2021年3月  |
|  第三届   | 北见纱和子-契约  |  402402   | 2021年7月  |
|  第四届   |   福姬-契约   |  403802   | 2021年11月 |
| 22年春季赛 |  艾丽莎-契约   |  403202   |
| 22年夏季赛 |  七海礼奈-契约  |  404402   |
| 22年秋季赛 |  泽克斯-契约   |  406002   |
| 22年冬季赛 |  抚子-细雪呈瑞  |  400604   |
| 23年春季赛 | 小鸟游雏田-契约* |  401902*  |
| 23年夏季赛 |     柚     |  405901   |
| 23年秋季赛 | 八木唯-魇魔之约  |  400704   |
| 23年冬季赛 |  一姬-新年初诣  |  400104   |
| 24年春季赛 | 五十岚阳菜-契约  |  402002   |
| 24年夏季赛 |    卡维     |  401001   |
| 24年秋季赛 |    岚星     |  407401   |
| 24年冬季赛 | 七海礼奈-白色礼赞 |  404403   |
| 25年春季赛 |  相原舞-契约   |  400502   |
| 25年夏季赛 |   凉宫杏树    |  402101   |
| 25年秋季赛 |    袁枫     |  408501   |

*23年春季赛用的"小鸟游雏田-契约"与游戏中实际实装的有一定区别, 多了个wink表情,
详见 [官方动态](https://www.bilibili.com/opus/760899056348168246)

下面是我自己仿照动态拼接做的[立绘](pic/小鸟游雏田-契约-改.png)

![pic/小鸟游雏田-契约-改](pic/小鸟游雏田-契约-改.png)

还有一个类似的改动是19年4月角色"藤田佳奈"的生日图, 详见 [官方动态](https://www.bilibili.com/opus/246917949025436769)

下面这个也是我自己仿照动态拼接做的[立绘](pic/藤田佳奈-改.png)

![pic/藤田佳奈-改](pic/藤田佳奈-改.png)

此外, 2021年5月北斗战的宣传及视频封面是 pixiv id: [98623820](https://www.pixiv.net/artworks/98623820)

### 雀魂FATE联动纪念大赛: 最强职阶决定战 所用看板角色和其他信息

|    比赛     |                      邀请嘉宾                       |                         额外解说                          | 看板角色 |
|:---------:|:-----------------------------------------------:|:-----------------------------------------------------:|:----:|
|   Saber   |    [逍遥散人](https://space.bilibili.com/168598)    |                           无                           |  伊芙  |
|  Lancer   |  [永雏塔菲](https://space.bilibili.com/1265680561)  |                           无                           |  一姬  |
|  Archer   |   [赫萝老师](https://space.bilibili.com/1351379)    | [神社娘月桂叶(pane)](https://space.bilibili.com/1274776147) | 泷川夏彦 |
|   Rider   |   [菠萝赛东°](https://space.bilibili.com/197098)    |   [赤五教教主亮亮](https://space.bilibili.com/1697848019)    | 辉夜姬  |
|  Caster   | [Asaki大人](https://space.bilibili.com/194484313) | [神社娘月桂叶(pane)](https://space.bilibili.com/1274776147) |  卡维  |
| Assassin  |  [火龙果说电影](https://space.bilibili.com/40665101)  |      [傅红雪](https://space.bilibili.com/36655150)       | A-37 |
| Berserker |    [杆菌无敌](https://space.bilibili.com/164627)    |     [火龙果说电影](https://space.bilibili.com/40665101)     | 凉宫杏树 |
|    总决赛    |  [异灵术老师](https://space.bilibili.com/383671544)  |      [傅红雪](https://space.bilibili.com/36655150)       | (全部) |

### 问卷: 目前雀魂就细节上还能优化的点(短期内能实现)

1. 查看每周轮换的活动场的队列
2. "役种一览"新增赤羽之战模式规则下特有的番种
3. 设置中实装默认屏蔽对局玩家的表情的功能按钮, 供有需要的玩家

### 问卷: 目前雀魂就对局上还能优化的点(短期内很难实现)

1. 人物立直, 胡牌专属动作(要看猫粮的3D动画师水平怎么样了, 就目前动态立绘所体现出的水平而言, 该项遥遥无期)
2. 对局内可以换装扮和人物(这可能涉及到了底层逻辑了, 因为从牌谱信息文件的格式我们知道对局玩家的信息整局都不会变,
   从匹配预约不允许换角色也能看出来, 当然也不是一点办法没有, 比如)
    - 将第一小局所用的人物和装扮作为"对局玩家的信息", 之后的小局"放开"随机, 但这样会导致在牌谱回放时, 整场对局只显示第一小局的人物和装扮

### 查询好友列表中玩家的 `account_id`

`uiscript.UI_Friend.Inst.page_friend.cells[0].account_id`

执行该脚本需要进入到好友列表界面, 其中下标0换成想要的查询的玩家的下标, 从上到下依次排列

同样的, 查看申请好友的玩家的是 `uiscript.UI_Friend.Inst.page_apply.playerinfos[0].account_id`

最近对局玩家的是 `uiscript.UI_Friend.Inst.page_recent.player_list[0].account_id`

以上操作都需要进入到对应界面, 否则会加载不出来报错

### 查询任意已知 `account_id` 的玩家信息(像对局中查看其他玩家水表)

`uiscript.UI_PlayerInfo.Inst.show({accountId: ${ACCOUNT_ID}})`

把 `${ACCOUNT_ID}` 换成你要查询玩家的 `account_id`, 在控制台中输入, 就会像在对局中一样查看玩家信息

已经永封, 甚至已经注销的账号, 信息仍然可以查看

### 对局中玩家显示和牌字样

- 荣和: `uiscript.UI_Huleshow.Inst.showRong(allseats)`
- 自摸: `uiscript.UI_Huleshow.Inst.showZimo(allseats)`

其中 `allseats` 表示要和牌的玩家列表, 用数组表示, 如 `[0, 1, 2, 3]`

### 牌谱界面显示操作按钮

操作按钮分两类: 自家巡目的操作, 他家巡目的操作, 后面的数字是操作种类的 `type` 和属性名, 具体可见
`mjcore.E_PlayOperation`

自家巡目的操作需要使用函数 `uiscript.UIMgr.Inst.ShowLiqiZimo`, 操作有

- 暗杠: 4, `an_gang`
- 加杠: 6, `add_gang`
- 立直: 7, `liqi`
- 自摸: 8, `zimo`
- 九种九牌: 10, `jiuzhongjiupai`
- 拔北: 11, `babei`
- 暗牌: 14, `reveal`
- 锁定: 16, `locktile`
- 暗牌立直: 17, `revealliqi`
- 真·立直: 19, `po_liqi_5000`
- 极·立直: 20, `po_liqi_10000`

他家巡目的操作需要使用函数 `uiscript.UIMgr.Inst.ShowChipenghu`, 操作有

- 吃: 2, `eat`
- 碰: 3, `peng`
- 明杠: 5, `ming_gang`
- 荣和: 9, `rong`
- 开牌: 15, `unveil`

操作必须使用相应的函数, 否则只会显示"取消"

两个函数不是互斥的, 可以叠加(但会很乱看不清)

使用方式是 函数名 + `([{type: ${type}])`, 把 `${type}` 换成对应操作的数字, 如

`uiscript.UIMgr.Inst.ShowLiqiZimo([{type: 8}])`

暗杠, 加杠的按钮一样, 而且还需要加上 `combination` 属性, 值只要为数组或者字符串且不为空即可, 如

`uiscript.UIMgr.Inst.ShowLiqiZimo([{type: 4, combination: [1]}])`

不止一个操作时, 在数组内添加即可, 如

`uiscript.UIMgr.Inst.ShowChipenghu([{type: 2}, {type: 3}, {type: 5}, {type: 9}, {type: 15}])`

`uiscript.UIMgr.Inst.ShowLiqiZimo([{type: 4, combination: [1]}, {type: 7}, {type: 8}, {type: 10}, {type: 11}, {type: 14}, {type: 16}, {type: 17}, {type: 19}, {type: 20}])`

后者显示不下了, 真·立直和流局重叠了

需要注意在运行 `ShowChipenghu` 之前最好让牌谱中玩家切一下牌, 否则虽然会显示按钮, 但控制台会报错, 且没有音效

若要消除按钮显示, 切换视角就行

注意点击按钮是没有效果的, 就像在观战界面一样

### 牌谱界面显示或不显示某些按钮或画面

不显示"听牌提示"按钮: `uiscript.UI_Replay.Inst.tingTipBtn.visible = false;`

不显示切换"工具栏"显示状态的按钮: `uiscript.UI_Replay.Inst.ctrlShowBtn.visible = false;`

不显示"工具栏": `uiscript.UI_Replay.Inst.changeRootVisible(false);`

显示"振听": `uiscript.UI_DesktopInfo.Inst.img_zhenting.visible = true`

若要重新显示把上述 `false` 改成 `true` 即可

### 普通/匿名牌谱, 三种用户id的互转

假设 `input` 是下面过程"=>"左边的内容, 则函数返回的就是右边的内容

---

#### 牌谱互转

这里的 `input` 是牌谱的 UUID, 只是链接的一部分,
是介于链接字符串的等号 `=` (不包括) 和第一个下划线 `_` (不包括) 之间的用短横线 `-` 链接的那部分

- 普通牌谱 => 匿名牌谱: `game.Tools.EncodePaipuUUID(input)`
- 匿名牌谱 => 普通牌谱: `game.Tools.DecodePaipuUUID(input)`

#### id互转

用户的id有三种: 

- 账号id, 这个是最基本的id, 也是牌谱屋界面网址所显示的id, 游戏内通常不可见
- 牌谱id, 在分享的牌谱链接最后有个以 `_a` 开头的一串数字, 那就是牌谱id
- 好友id, 加好友用的id

于是就有了6种情况, 其中最后2种是完全通过现有函数调用实现的

- 牌谱id => 账号id: `game.Tools.decode_account_id(input)`
- 账号id => 牌谱id: `game.Tools.encode_account_id(input)`
- 好友id => 账号id: `game.Tools.decode_account_id2(input)`
- 账号id => 好友id: `game.Tools.encode_account_id2(input)`
- 牌谱id => 好友id: `game.Tools.encode_account_id2(game.Tools.decode_account_id(input))`
- 好友id => 牌谱id: `game.Tools.decode_account_id2(game.Tools.encode_account_id(input))`

### 中文服稀有称号用户

- 天选之证: 10566203

### 某个加解密的分析

加密: `game.Tools.eeesss(string)`

解密: `game.Tools.dddsss(string)`

原文密文都是字符串, 经观察有以下特点:

- 原文密文长度相同
- 原文长度不变的情况下, 更改原文的某个字符只会影响密文某个特定位置的字符, 且更改原文相邻字符也只会影响密文的相邻字符

可以得出结论: 这是简单的等长线性偏移加密, 于是问题就变成了如何得出'位置偏移量'和'字符偏移量'

#### 位置偏移量

经研究, 位置偏移量只与原文的长度有关, 如果原文的长度为 `len`, 则原文下标为 `i` 的字符, 
在密文中的下标为 `(Math.floor(len / 3) + 17 + len - i) % len`

由于原文密文长度一致, 且下标对应关系近似负相关, 则明密文中字符下标具有对称性

直观上解释, 有个分割点下标 `split_index`, 值为 `(Math.floor(len / 3) + 17) % len`, 下标不超过这个的子串划分为一部分, 剩下的为另一部分
两部分分别逆序, 就得到了该位置偏移的效果

#### 字符偏移量

字符偏移需要用到编码数组 `dict`, 长度90, 它的构成是这样的:

- 前26位为小写字母字符a-z
- 往后26位为大写字母字符A-Z
- 再往后10位为数字字符0-9
- 最后28位是 `!@#$%^&*()-_=+{}[]|:;<>,.?/~`

字符偏移量与上述编码数组和位置有关, 结论是

原文下标为 `i` 的字符, 在 `dict` 中下标为 `j`, 则对应的密文字符在 `dict` 中的下标为 `(j + 2 + 3 * i ^ 11) % 90`

密文下标为 `k` 的字符, 在 `dict` 中下标为 `l`, 则对应的原文字符在 `dict` 中的下标为 `((l - (2 + 3 * k ^ 11)) % 90 + 90) % 90`

可以发现, 原文的长度不影响字符偏移量, 二者差别仅在加号变减号, 以及保证值为正数的额外求模和加法

如果出现不在 `dict` 中的字符(如空格), 则该字符不会变化, 原文与密文差别仅在位置
